---
title: "Fanfiction Review Data Visualizations"
author: "Allen Zhou"
date: "10/28/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)
library(stringr)

setwd("E:\\UW\\Autumn Quarter 2021\\HCDE 496\\visualizations")
file <- paste(getwd(), "/data/fall_2020_-_batch_tewzr_allen_zhou.csv", sep="")

data <- read.csv(file)
```

Organizing the Data

Part 1

```{r, echo=TRUE}

#hand-drawn idea data
positive <- filter(data, Valence == "Positive")
nrow(positive)
neutral <- filter(data, Valence == "Neutral")
nrow(neutral)
negative <- filter(data, Valence == "Negative")
nrow(negative)
unknown <- filter(data, Valence == "Unknown")
nrow(unknown)

```

Hand-Drawn Data Visualization

![hand-drawn visualization idea](images/hand-drawn-visual.png)

Parts 2 and 3

```{r, echo=FALSE}

#code/software generated idea

review_text <- select(data, Text) %>%
  mutate(word_count = str_count(Text, '\\w+'))

review_text_positive <- select(positive, Text) %>%
  mutate(word_count = str_count(Text, '\\w+'))
review_text_neutral <- select(neutral, Text) %>%
  mutate(word_count = str_count(Text, '\\w+'))
review_text_negative <- select(negative, Text) %>%
  mutate(word_count = str_count(Text, '\\w+'))
review_text_unknown <- select(unknown, Text) %>%
  mutate(word_count = str_count(Text, '\\w+'))

```

Word Count Visualization

```{r, echo=TRUE}

word_chart <- ggplot(review_text, aes(x=word_count)) +
  geom_histogram(binwidth=1, fill="black") +
  xlim(0, 600) +
  ylim(0, 25) +
  labs(title = "Fanfiction Review Word Counts by Frequency")
update_labels(word_chart, list(x = "Word Count", y = "Frequency"))

```

Word Count By Valence Visualization

```{r, echo=TRUE}

word_chart_positive <- ggplot(review_text_positive, aes(x=word_count)) +
  geom_histogram(binwidth=1, fill="green") +
  xlim(0, 600) +
  ylim(0, 25) +
  labs(title = "Fanfiction Review Word Counts by Frequency")
update_labels(word_chart_positive, list(x = "Word Count", y = "Frequency"))

word_chart_neutral <- ggplot(review_text_neutral, aes(x=word_count)) +
  geom_histogram(binwidth=1, fill="yellow") +
  xlim(0, 600) +
  ylim(0, 25) +
  labs(title = "Fanfiction Review Word Counts by Frequency")
update_labels(word_chart_neutral, list(x = "Word Count", y = "Frequency"))

word_chart_negative <- ggplot(review_text_negative, aes(x=word_count)) +
  geom_histogram(binwidth=1, fill="red") +
  xlim(0, 600) +
  ylim(0, 25) +
  labs(title = "Fanfiction Review Word Counts by Frequency")
update_labels(word_chart_negative, list(x = "Word Count", y = "Frequency"))

word_chart_unknown <- ggplot(review_text_unknown, aes(x=word_count)) +
  geom_histogram(binwidth=1, fill="blue") +
  xlim(0, 600) +
  ylim(0, 25) +
  labs(title = "Fanfiction Review Word Counts by Frequency")
update_labels(word_chart_unknown, list(x = "Word Count", y = "Frequency"))

```
